import axios from 'axios'
import React, { useEffect, useState } from 'react'
import {Chart as ChartJS,BarElement, CategoryScale, LinearScale} from 'chart.js'
import {Bar} from 'react-chartjs-2'
import about from './about.jpg'
function Dashboard() {
  //CHart 

  ChartJS.register(
    CategoryScale,
    LinearScale,
    BarElement
  )
  var options = {
    maintainAspectRatio: false,
  scales: {
  },
  legend: {
    labels: {
      fontSize: 9,
    },
  },
}
//Donné
const [donne,setdonne]=useState({
  medecins:0,operations:0,consultations:0,patients:0,infermieres:0
})
const [ChartPatient,setChartPatient]=useState({
  month:0,count:0
})
const [patientJour,setpatientJour]=useState()
const apiUrl = import.meta.env.VITE_API_BASE_URL
useEffect(()=>{
  axios.get(`${apiUrl}/dashboard`)
  .then((data)=>{
    donne.medecins=data.data.medecins
    donne.operations=data.data.operations
    donne.consultations=data.data.consultations
    donne.patients=data.data.patients
    donne.infermieres=data.data.infermieres
  })
  .catch((err)=>{
    console.log(err.message)
  })
  axios.get(`${apiUrl}/DashPatients`)
  .then((data)=>{
    ChartPatient.count=data.data.count
    ChartPatient.month=data.data.month
  })
  .catch((err)=>{
    console.log(err.message)
  })
  axios.get(`${apiUrl}/PatientDeJour`)
  .then((data)=>{
    setpatientJour(data.data.patientsAddedToday)
  })
  .catch((err)=>{
    console.log(err.message)
  })
  },[])
const data = {
labels: ChartPatient.month,
datasets: [{
  label: 'Patients',
  data: ChartPatient.count,
  backgroundColor: [
    'rgba(255, 99, 132, 0.2)',
    'rgba(255, 159, 64, 0.2)',
    'rgba(255, 205, 86, 0.2)',
    'rgba(75, 192, 192, 0.2)',
    'rgba(54, 162, 235, 0.2)',
    'rgba(153, 102, 255, 0.2)',
    'rgba(201, 203, 207, 0.2)'
  ],
  borderColor: [
    'rgb(255, 99, 132)',
    'rgb(255, 159, 64)',
    'rgb(255, 205, 86)',
    'rgb(75, 192, 192)',
    'rgb(54, 162, 235)',
    'rgb(153, 102, 255)',
    'rgb(201, 203, 207)'
  ],
  borderWidth: 1
}]
}
return (
    <div>
        <div className="container-fluid">
          <div className="row p-4">
            <div className="col mx-4 w-25 h-25 shadow bg-light text-center p-2">
              <span>
                <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 48 48"><g fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"><path d="m16.649 9.326l.055-.24c.105-.446.277-1.102.632-1.748c.362-.658.923-1.325 1.803-1.764c.877-.437 1.976-.6 3.335-.42c1.5.2 4.513.696 7.175 2.05c2.677 1.362 5.185 3.705 5.185 7.607c0 2.016-.78 4.179-1.536 5.589c-.363.678-.794 1.326-1.226 1.675c-.099.08-.24.18-.415.25a8.004 8.004 0 0 1-15.05.738l-.024.004l-.355-.431L17 22l-.772.636l-.001-.002l-.002-.002l-.005-.007l-.017-.02a6.849 6.849 0 0 1-.247-.327a13.446 13.446 0 0 1-.61-.924c-.47-.778-1.037-1.886-1.4-3.179c-.362-1.293-.528-2.809-.148-4.373c.37-1.522 1.243-3.02 2.824-4.358l.027-.118Zm1.68 12.638a6.003 6.003 0 0 0 11.564-.833l.113.038a2.43 2.43 0 0 1-.006-.17c0-1.655-.23-2.81-.444-3.53a6.71 6.71 0 0 0-.139-.416l-.041.002h-.04a11.485 11.485 0 0 1-2.232-.17c-1.717-.29-4.042-1.014-6.78-2.691c-.06.134-.12.285-.18.453c-.196.555-.357 1.214-.496 1.91c-.123.613-.224 1.23-.32 1.808l-.037.228c-.103.62-.206 1.229-.326 1.67c-.21.766-.424 1.31-.636 1.7Zm-1.4-1.863a10.949 10.949 0 0 1-1.056-2.465c-.299-1.066-.409-2.22-.131-3.361c.27-1.11.923-2.277 2.266-3.383c.242-.164.352-.384.382-.443v-.001a1.91 1.91 0 0 0 .126-.337c.032-.114.067-.27.1-.41l.035-.157c.095-.403.218-.842.438-1.243c.214-.388.507-.72.943-.937c.438-.219 1.116-.369 2.178-.227c1.453.193 4.186.656 6.532 1.85c2.33 1.185 4.092 2.979 4.092 5.824c0 1.31-.44 2.8-.97 3.975c-.1-.766-.244-1.392-.392-1.888a7.656 7.656 0 0 0-.385-1.037a4.507 4.507 0 0 0-.19-.365l-.017-.027l-.006-.01l-.003-.005l-.002-.003l-.84.54l.84-.54l-.37-.574l-.662.133l-.014.003l-.097.013a5.093 5.093 0 0 1-.448.03a9.487 9.487 0 0 1-1.84-.144c-1.613-.272-3.983-1.013-6.862-2.93l-.7-.467l-.579.61c-.477.502-.801 1.187-1.038 1.854c-.242.685-.425 1.45-.572 2.184a53.34 53.34 0 0 0-.332 1.88l-.038.224c-.107.651-.194 1.148-.282 1.47a9.214 9.214 0 0 1-.106.364Zm13.881.422l.004-.002l-.004.002Zm.004-.002Zm0 0l-.004.002l.003-.002Z"/><path d="M17.914 28.855c-.212-.422-.473-.943-.914-.842c-5.404 1.23-11 4.781-11 8.557V42h36v-5.43c0-2.974-3.472-5.809-7.587-7.48l-.005-.01a1.461 1.461 0 0 0-.014-.027l-.033.016c-1.093-.44-2.231-.8-3.361-1.056c-.503-.115-1.023.577-1.25 1.01H18c-.028-.052-.056-.11-.086-.168Zm13.489 1.32c.437.121.872.257 1.301.407c.012.342-.014.746-.07 1.158a8.092 8.092 0 0 1-.272 1.26H31a1 1 0 0 0-.894.553l-1 2A1 1 0 0 0 29 36v2a1 1 0 0 0 1 1h2v-2h-1v-.764L31.618 35h2.764L35 36.236V37h-1v2h2a1 1 0 0 0 1-1v-2a1 1 0 0 0-.106-.447l-1-2A1 1 0 0 0 35 33h-.566a10.66 10.66 0 0 0 .248-1.609c.975.461 1.881.99 2.666 1.562C39.27 34.355 40 35.667 40 36.57V40H8v-3.43c0-.903.73-2.215 2.652-3.617c.966-.705 2.119-1.343 3.355-1.871a10.179 10.179 0 0 0 .381 2.354l.008.028a3 3 0 1 0 1.956-.444a8.092 8.092 0 0 1-.28-1.28a7.01 7.01 0 0 1-.069-1.171a3.99 3.99 0 0 1 .015-.224c.12-.037.24-.073.36-.107l.415.786h14.164l.446-.848ZM16 37.016c.538 0 1-.44 1-1.015c0-.574-.462-1.015-1-1.015s-1 .44-1 1.015c0 .574.462 1.015 1 1.015Z"/></g></svg>
                </span>
                <h2>Medecins</h2>
                <h5>{donne.medecins}</h5>
            </div>
            <div className="col mx-4 w-25 h-25 shadow bg-light text-center p-2">
              <span>
                <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 48 48"><g fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"><path d="M32.263 8.356c.03.036.058.075.083.114l.001.002l.003.005l.009.015l.032.053a26.166 26.166 0 0 1 .531.927c.34.622.791 1.5 1.243 2.538C35.06 14.06 36 16.827 36 19.463c0 2.983-2.015 4.637-3.787 5.491a11.74 11.74 0 0 1-2.776.915A7.972 7.972 0 0 1 24 27.998a7.985 7.985 0 0 1-6.257-3.013l-.046-.004a7.997 7.997 0 0 1-.649-.086a7.897 7.897 0 0 1-1.97-.606c-.73-.34-1.506-.862-2.1-1.663c-.603-.813-.978-1.859-.978-3.164c0-2.467 1.202-5.27 2.306-7.352a36.356 36.356 0 0 1 2.206-3.619l.032-.045l.012-.019a5.486 5.486 0 0 1 .413-.548a7.368 7.368 0 0 1 1.32-1.195C19.503 5.821 21.373 5 24.055 5c2.675 0 4.712.817 6.084 1.643c.685.413 1.204.827 1.557 1.144a7.494 7.494 0 0 1 .55.55l.01.012l.005.005l.001.002ZM18.237 9.512a.996.996 0 0 1-.048.074l-.002.002l-.008.01l-.033.048a29.46 29.46 0 0 0-.611.911c-.4.62-.932 1.49-1.462 2.49C14.987 15.095 14 17.523 14 19.463c0 .899.25 1.522.584 1.973c.344.462.819.8 1.339 1.042c.247.115.497.206.735.277a24.259 24.259 0 0 1-.429-2.6c-.113-1.074-.146-2.265.056-3.318c.199-1.032.668-2.141 1.742-2.718c1.429-.767 3.847-1.793 5.979-2.5c1.063-.353 2.1-.642 2.929-.774c.407-.064.825-.1 1.193-.063c.288.03.885.139 1.215.68c2.68 3.869 2.72 7.414 2.041 10.003c-.196.748-.45 1.412-.712 1.976a8.7 8.7 0 0 0 .672-.288c1.45-.7 2.656-1.814 2.656-3.69c0-2.222-.81-4.686-1.668-6.654a30.258 30.258 0 0 0-1.546-3.051l-.094-.159l-.024-.025l-.011-.012a5.513 5.513 0 0 0-.298-.287a8.256 8.256 0 0 0-1.252-.918C27.99 7.683 26.305 7 24.055 7c-2.244 0-3.712.679-4.606 1.315a5.37 5.37 0 0 0-.961.867a3.488 3.488 0 0 0-.246.322l-.005.008ZM32.346 8.47l-.848.53l.848-.53Zm-.848.53l.765-.644l-.765.644ZM18.742 22.894a22.73 22.73 0 0 1-.524-2.947c-.105-.993-.118-1.96.03-2.733c.153-.792.43-1.175.724-1.333c1.307-.702 3.616-1.685 5.663-2.364c1.026-.34 1.942-.59 2.612-.696c.253-.04.439-.055.565-.054c2.198 3.268 2.175 6.137 1.636 8.191a9.89 9.89 0 0 1-1.053 2.517a8.252 8.252 0 0 1-.565.834l-.007.009l-.021.026l-.004.004l-.001.001a.999.999 0 0 0-.224.471a5.998 5.998 0 0 1-8.83-1.926ZM27.98 12.78a.128.128 0 0 1-.026-.006a.089.089 0 0 1 .026.006Z"/><path d="M17.914 28.855c-.212-.422-.473-.943-.914-.842c-5.404 1.23-11 4.782-11 8.557V42h36v-5.43c0-2.974-3.472-5.808-7.587-7.48l-.014-.027l-.005-.01l-.033.016c-1.093-.44-2.231-.8-3.361-1.056c-.503-.115-1.023.577-1.25 1.01H18a9.88 9.88 0 0 1-.086-.168Zm13.489 1.321c.437.12.872.257 1.301.407c.012.342-.014.745-.07 1.157a8.087 8.087 0 0 1-.272 1.26H31a1 1 0 0 0-.894.553l-1 2A.999.999 0 0 0 29 36v2a1 1 0 0 0 1 1h2v-2h-1v-.764L31.618 35h2.764L35 36.236V37h-1v2h2a1 1 0 0 0 1-1v-2a.999.999 0 0 0-.106-.447l-1-2A1 1 0 0 0 35 33h-.566a10.66 10.66 0 0 0 .248-1.608c.975.46 1.881.988 2.666 1.56C39.27 34.356 40 35.668 40 36.57V40H8v-3.43c0-.903.73-2.215 2.652-3.617c.966-.705 2.119-1.343 3.355-1.871a10.179 10.179 0 0 0 .381 2.354l.008.028a3 3 0 1 0 1.956-.444a8.087 8.087 0 0 1-.28-1.28a7.012 7.012 0 0 1-.069-1.171a3.99 3.99 0 0 1 .015-.224c.12-.037.24-.073.36-.107l.415.786h14.164l.446-.848ZM16 37.015c.538 0 1-.44 1-1.015c0-.574-.462-1.015-1-1.015s-1 .44-1 1.015c0 .574.462 1.015 1 1.015Z"/></g></svg>
</span>
                <h2>Infermieres</h2>
                <h5>{donne.infermieres}</h5>
            </div>
            <div className="col mx-4 w-25 h-25 shadow bg-light text-center p-2">
              <span>
              <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24"><path fill="currentColor" d="M12 10c2.21 0 4-1.79 4-4s-1.79-4-4-4s-4 1.79-4 4s1.79 4 4 4m0-6c1.1 0 2 .9 2 2s-.9 2-2 2s-2-.9-2-2s.9-2 2-2m6.39 8.56C16.71 11.7 14.53 11 12 11s-4.71.7-6.39 1.56A2.97 2.97 0 0 0 4 15.22V22h2v-6.78c0-.38.2-.72.5-.88C7.71 13.73 9.63 13 12 13c.76 0 1.47.07 2.13.2l-1.55 3.3H9.75C8.23 16.5 7 17.73 7 19.25S8.23 22 9.75 22H18c1.1 0 2-.9 2-2v-4.78c0-1.12-.61-2.15-1.61-2.66M10.94 20H9.75c-.41 0-.75-.34-.75-.75s.34-.75.75-.75h1.89l-.7 1.5M18 20h-4.85l2.94-6.27c.54.2 1.01.41 1.41.61c.3.16.5.5.5.88V20Z"/></svg>
                </span>
                <h2>Patients</h2>
                <h5>{donne.patients}</h5>
            </div><div className="col mx-4 w-25 h-25 shadow bg-light text-center p-2">
              <span>
                <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 48 48"><g fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"><path d="M23.889 9.5a4.502 4.502 0 0 0-8.889 1a4.5 4.5 0 0 0 8.888 1H24a.998.998 0 0 0 .123-.008c.23.887.76 1.508 1.377 1.508c.828 0 1.5-1.12 1.5-2.5S26.328 8 25.5 8c-.617 0-1.147.62-1.377 1.507A1.012 1.012 0 0 0 24 9.5h-.111Zm-2.123 2.059a2.5 2.5 0 0 1-4.733-.655c1.628.72 3.029.716 4.732.655Zm-4.219-2.62a2.5 2.5 0 0 1 4.264.606l-.026.001c-1.842.063-2.852.097-4.238-.607Zm-8.92 10.56C10.28 17.518 12.76 16 15.76 16a3 3 0 0 1 2.864 2.107l1.275 4.09H21a3 3 0 0 1 0 6h-3.309a3 3 0 0 1-2.849-2.063A14.527 14.527 0 0 0 14 29.618V39a3 3 0 1 1-6 0v-6.988c-.193-.306-.43-.701-.672-1.143a14.496 14.496 0 0 1-.834-1.785C6.266 28.48 6 27.616 6 26.69c0-2.628.988-5.225 2.627-7.191ZM15.76 18c-2.286 0-4.24 1.153-5.597 2.78C8.812 22.4 8 24.548 8 26.69c0 .57.169 1.169.365 1.688c.202.536.466 1.07.719 1.534a19.768 19.768 0 0 0 .755 1.265a1 1 0 0 1 .161.544V39a1 1 0 1 0 2 0v-9.435c0-.036.002-.07.005-.105c.268-2.53 1.153-4.804 2.149-6.582a1 1 0 0 1 1.827.192l.756 2.424a1 1 0 0 0 .954.702H21a1 1 0 1 0 0-2h-1.837a1 1 0 0 1-.955-.702l-1.493-4.792A1 1 0 0 0 15.76 18Zm21.74 0a4.5 4.5 0 1 0 0-9a4.5 4.5 0 0 0 0 9Zm0-2a2.5 2.5 0 1 0 0-5a2.5 2.5 0 0 0 0 5Z"/><path d="M34.379 17.77a3 3 0 0 0-3.335-1.71l-.035.008h-.003l-.015.004l-.021.005h-.003a4.285 4.285 0 0 0-.511.15a6.89 6.89 0 0 0-.936.41c-.727.383-1.611 1-2.461 1.977C25.32 20.609 24 23.78 24 28.667c0 .51.099 2.273 1.854 3.137c.17.084.335.148.492.196H16v10h2v-7h11v7h2v-8.46a35.822 35.822 0 0 1 2.546 1.947c.078.124.18.29.301.494c.276.462.62 1.056.977 1.674l.505.88l.003.005l.027.046v.002h.001c.5.871.984 1.715 1.182 2.025a3 3 0 0 0 5.059-3.226a83.65 83.65 0 0 1-.986-1.697l-.002-.003l-.59-1.027c-.358-.62-.723-1.25-1.024-1.754a30.6 30.6 0 0 0-.418-.683l-.005-.009c-.084-.132-.274-.432-.485-.675a5.178 5.178 0 0 0-.492-.48l-.018-.016a24.182 24.182 0 0 0-.53-.446a41.687 41.687 0 0 0-1.984-1.53H39a3 3 0 0 0 0-6h-2.239L34.38 17.77Zm-2.85 13.716a.988.988 0 0 0-.121-.067a.986.986 0 0 0-.111-.081c-.583-.369-1.168-.7-1.684-.916c-.801-.336-1.358-.303-1.806-.277l-.04.003a4.279 4.279 0 0 1-.397.01a1.547 1.547 0 0 1-.633-.148c-.652-.32-.737-.974-.737-1.343c0-4.519 1.215-7.186 2.567-8.74a6.583 6.583 0 0 1 1.884-1.52a4.874 4.874 0 0 1 .793-.334a.995.995 0 0 0 .355-.072a1 1 0 0 1 .956.589l2.648 5.887a1 1 0 0 0 .912.59H39a1 1 0 1 1 0 2h-4.179a1 1 0 0 1-.912-.59l-1.023-2.275a1 1 0 0 0-1.837.031a15.2 15.2 0 0 0-.953 3.403a1 1 0 0 0 .568 1.065c1.188.549 2.547 1.476 3.613 2.267c.59.438 1.114.853 1.505 1.174c.195.16.36.3.484.408l.01.009c.041.036.097.085.157.14c.062.059.113.11.145.147c.046.053.101.128.161.214c.059.085.11.167.154.234c.11.174.243.392.389.637c.293.49.65 1.108 1.008 1.727l.59 1.028l.002.003l.034.06c.463.805.855 1.488.999 1.714a1 1 0 1 1-1.687 1.075a86.145 86.145 0 0 1-1.163-1.997v-.001c-.169-.293-.34-.593-.508-.883c-.357-.619-.708-1.225-.992-1.7a26.498 26.498 0 0 0-.417-.678a1 1 0 0 0-.18-.206l-.016-.015a20.417 20.417 0 0 0-.44-.37a37.786 37.786 0 0 0-1.428-1.114a30.832 30.832 0 0 0-1.556-1.088Z"/></g></svg>
                </span>
                <h2>Consultations</h2>
                <h5>{donne.consultations}</h5>
            </div><div className="col mx-4 w-25 h-25 shadow bg-light text-center p-2">
              <span>
              <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 48 48"><path fill="currentColor" fill-rule="evenodd" d="M16.096 11.105a3.771 3.771 0 0 0-5.333-.002l-.704.704a3.953 3.953 0 0 0-3.892 1.021a4.034 4.034 0 0 0 0 5.676l.833.839V30H4v2h2.05a3.5 3.5 0 1 0 4.899 0h26.102a3.5 3.5 0 1 0 4.899 0H44v-2h-4v-3.113a3.962 3.962 0 0 0 3-3.854c0-2.19-1.761-3.967-3.934-3.967H18.11a.307.307 0 0 1-.218-.09l-.366-.37l.369-.367a3.77 3.77 0 0 0 .001-5.333l-1.8-1.8Zm.02 6.083l.365-.364a1.77 1.77 0 0 0 0-2.504l-1.8-1.8a1.771 1.771 0 0 0-2.504-.002l-.35.35l4.29 4.32ZM41 23.033c0-1.102-.882-1.967-1.934-1.967H18.11a2.307 2.307 0 0 1-1.636-.68l-6.106-6.148a1.953 1.953 0 0 0-2.782 0a2.034 2.034 0 0 0 0 2.857L15.438 25h23.628C40.12 25 41 24.135 41 23.033Zm-26.725 3.634c.212.213.498.333.797.333H38v3H9v-8.644l5.275 5.311ZM10 34.5a1.5 1.5 0 1 1-3 0a1.5 1.5 0 0 1 3 0ZM39.5 36a1.5 1.5 0 1 0 0-3a1.5 1.5 0 0 0 0 3Z" clip-rule="evenodd"/></svg>
                </span>
                <h2>Operations</h2>
                <h5>{donne.operations}</h5>
            </div>
          </div>
          </div> 
          
        <div className="container bg-light shadow rounded-4 p-2">
                <h1 className='text-center text-secondary w-100'>Statistiques</h1>
              <br />
              <div className="row">
<div className="col-12 col-md-6 text-center">
                    <h3 className=' bg-info p-2 text-light'>Patient Per Mounth</h3>
                    
                    <span className='text-center'>
                      <Bar
        data={data} height={400} width={'100%'} options={options}/>
                    </span>
                  
                  </div>
                  <div className="col-12 col-md-6 text-center">
                    <h3 className='bg-secondary p-2 text-light'>Patients D'Aujourd'hui</h3>     
                    {
                      patientJour?(
                          
                            patientJour.map((pat)=>{
                              return(
                                <div className="bg-light rounded-4 p-4">
                                  <b>{
                                    pat.Nom
                                  } - {pat.Prenom}
                                    </b>
                                  
                                  </div>
                              )
                            })
                          
                          
                      ):(
                        <h3>Aucun Patient</h3>
                      )
                    }               
                   <b>Count : {patientJour?.length}</b>
                  </div>
              </div>
              
                 

        </div>
        <div className="container text-dark  rounded-4 p-4">
                    <center>
                      <h2>About Us</h2><br />
                      <h5>
                      votre partenaire de confiance dans la révolution de la gestion des consultations médicales et des opérations de santé grâce à notre plateforme web innovante. Notre mission est de rationaliser l'expérience de la santé à la fois pour les patients et les prestataires de soins, en garantissant efficacité, accessibilité et des soins de haute qualité
                      </h5>
                    </center>
                    
                  </div>
       
        
    </div>
  )
}

export default Dashboard